# Loading Data into HDFS Before Using Hive LOAD DATA

This document explains how to copy data **into HDFS**
from the local file system (or other sources)
before using the `LOAD DATA` command in Apache Hive.

Hive cannot read data directly from the local file system.
Therefore, the data **must be available in HDFS**
before it can be loaded into a Hive table.

---

## 1. Why Must Data Be in HDFS?

Hive tables read data from HDFS.
For this reason, the path specified in the `LOAD DATA INPATH` command
must be an **HDFS path**.

Incorrect usage:
```sql
LOAD DATA INPATH '/home/user/data.csv'
INTO TABLE my_table;
```

Correct usage:
```sql
LOAD DATA INPATH '/user/train/data.csv'
INTO TABLE my_table;
```

---

## 2. Creating a Directory in HDFS

Before copying data into HDFS,
the target directory must exist.

The following command creates a directory in HDFS:

```bash
hdfs dfs -mkdir -p /user/train
```

To verify that the directory was created successfully:

```bash
hdfs dfs -ls /user
```

---

## 3. Copying Local Files to HDFS

To copy a file from the local file system to HDFS,
the `hdfs dfs -put` command is used.

Example:

```bash
hdfs dfs -put wine.csv /user/train/
```

This command:
- Takes the `wine.csv` file from the local directory
- Copies it into the `/user/train/` directory in HDFS

Alternatively, `-copyFromLocal` can be used:

```bash
hdfs dfs -copyFromLocal wine.csv /user/train/
```

---

## 4. Verifying Files in HDFS

To check whether the file was successfully copied to HDFS:

```bash
hdfs dfs -ls /user/train
```

To quickly inspect the file content:

```bash
hdfs dfs -head /user/train/wine.csv
```

---

## 5. Loading Data into a Hive Table Using LOAD DATA

Once the data is available in HDFS,
the following Hive command can be used to load it into a table:

```sql
LOAD DATA INPATH '/user/train/wine.csv'
INTO TABLE wine;
```

This command:
- Reads the data from HDFS
- Copies it into the Hive table
- Appends the data to existing table contents by default

---

## 6. Using LOAD DATA OVERWRITE

If existing data in the table should be removed
and replaced with new data,
the `OVERWRITE` option can be used:

```sql
LOAD DATA INPATH '/user/train/wine.csv'
OVERWRITE INTO TABLE wine;
```

This operation:
- Deletes existing data in the table
- Writes the new data into the table

---

## 7. Possible HDFS Permission Issues

If permission errors occur while loading data,
HDFS directory permissions should be checked.

```bash
hdfs dfs -ls /user
```

If necessary, permissions can be updated:

```bash
hdfs dfs -chmod -R 755 /user/train
```

---

## 8. Summary

In this document:

- It was explained why Hive reads data from HDFS
- Steps for creating directories in HDFS were shown
- Copying local files to HDFS was demonstrated
- Methods for verifying files in HDFS were explained
- Hive `LOAD DATA` and `OVERWRITE` usage was covered
- Common permission-related issues were discussed

These steps represent a **fundamental and essential**
part of the data loading workflow when working with Apache Hive.
